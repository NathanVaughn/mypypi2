handle offline upstream
handle 404s
tests